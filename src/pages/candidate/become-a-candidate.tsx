import { zodResolver } from "@hookform/resolvers/zod";
import Head from "next/head";
import React, { useState } from "react";
import { useForm } from "react-hook-form";
import { ThemeApplyer } from "~/components/ui";
import {
  FormSteps,
  CandidateInfo,
  CandidateContact,
  CandidateLocation,
  CandidateSocials,
} from "~/components/candidate/become-a-candidate";
import type {
  CandidateContactType,
  CandidateInfoType,
  CandidateLocationType,
  CandidateSocialsType,
} from "~/validation/candidate";
import {
  candidateContactSchema,
  candidateInfoSchema,
  candidateLocationSchema,
  candidateSocialsSchema,
} from "~/validation/candidate";

/**
 * Become a candidate page.
 */
const BecomeACandidate = () => {
  const [currentStep, setCurrentStep] = useState<number>(1);

  /**
   * Candidate Info
   */
  const candidateInfoFormMethods = useForm<CandidateInfoType>({
    resolver: zodResolver(candidateInfoSchema),
  });
  const [candidateInfoData, setCandidateInfoData] =
    useState<CandidateInfoType>();

  /**
   * Candidate Contact
   */
  const candidateContactFormMethods = useForm<CandidateContactType>({
    resolver: zodResolver(candidateContactSchema),
  });
  const [candidateContactData, setCandidateContactData] =
    useState<CandidateContactType>();

  /**
   * Candidate Location
   */
  const candidateLocationFormMethods = useForm<CandidateLocationType>({
    resolver: zodResolver(candidateLocationSchema),
  });
  const [candidateLocationData, setCandidateLocationData] =
    useState<CandidateLocationType>();

  /**
   * Candidate Socials
   */
  const candidateSocialsFormMethods = useForm<CandidateSocialsType>({
    resolver: zodResolver(candidateSocialsSchema),
  });
  const [candidateSocialsData, setCandidateSocialsData] =
    useState<CandidateSocialsType>();

  return (
    <>
      <Head>
        <title>RecruJobs/Welcome</title>
        <meta name="description" content="Generated by create-t3-app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className="relative flex h-screen w-screen items-center justify-center overflow-hidden ">
        <div className="space-y-8">
          {/* Form Page Title */}
          <h1 className="text-center text-4xl font-bold text-primary">
            Become a candidate
          </h1>
          {/* Form Steps */}
          <div className="flex w-full justify-center">
            <FormSteps step={currentStep} />
          </div>
          <div className="rounded-lg bg-primary bg-opacity-5 p-10">
            {currentStep === 1 && (
              <CandidateInfo
                methods={candidateInfoFormMethods}
                submitData={(data: CandidateInfoType) => {
                  setCandidateInfoData(data);
                  setCurrentStep((step) => step + 1);
                }}
              />
            )}
            {currentStep === 2 && (
              <CandidateContact
                methods={candidateContactFormMethods}
                goPreviousStep={() => setCurrentStep((step) => step - 1)}
                submitData={(data: CandidateContactType) => {
                  setCandidateContactData(data);
                  setCurrentStep((step) => step + 1);
                }}
              />
            )}
            {currentStep === 3 && (
              <CandidateLocation
                methods={candidateLocationFormMethods}
                goPreviousStep={() => setCurrentStep((step) => step - 1)}
                submitData={(data: CandidateLocationType) => {
                  setCandidateLocationData(data);
                  setCurrentStep((step) => step + 1);
                }}
              />
            )}
            {currentStep === 4 && (
              <CandidateSocials
                methods={candidateSocialsFormMethods}
                goPreviousStep={() => setCurrentStep((step) => step - 1)}
                submitData={(data: CandidateSocialsType) => {
                  setCandidateSocialsData(data);
                  setCurrentStep((step) => step + 1);
                }}
              />
            )}
          </div>
        </div>
        <ThemeApplyer />
      </main>
    </>
  );
};

export default BecomeACandidate;
